{
    "collab_server" : "",
    "contents" : "---\noutput: \n  pdf_document:\n    keep_tex: true\n    fig_caption: true\ntitle: \"SOC30005: Homework 7\"\nauthor: \"Ma Xiang-yu\"\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(\n  echo = FALSE,\n  options(digits = 3)\n)\n```\n\n```{r, include = FALSE}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(stringr)\nlibrary(knitr)\nlibrary(gmodels)\nlibrary(kableExtra)\nlibrary(stargazer)\nlibrary(haven)\nlibrary(modelr)\nlibrary(VIM)\nlibrary(mice)\n```\n\n# What affects public confidence in science? An examination of the effects of religion and education.\n\nIn the analysis that follows, I consider how religious attendance (that is, religious affiliation considered alongside regularity of church attendance) and education affect individuals' confidence in science. I found Gauchat's work on the politicization of science interesting (2012), and would like to extend it by considering other effects. In his work, Gauchat found that religious affiliation and frequency affected individual's perception of science, but never looked deeply at it.\n\nLet's see if there's something to it.\n\n# Data:\n\nI use pooled cross-sectional data from the 1972-2016 General Social Survey (GSS). \n\n```{r, include=FALSE}\nmaindata <- read_csv(\"abort_views.csv\")\n```\n\n## Dependent variable: Confidence in science\n\nFollowing Gauchat (2012), I recode confidence in science into a binary variable. Responses of \"A great deal\" are assigned 1.  Respones of \"Only some\", and \"Hardly\" are assigned 0. Responses of \"I don't know,\" \"No answer,\" and \"Not applicable\" are assigned NA values.\n\n```{r}\nmaindata$SCICONF <- NA\nmaindata$SCICONF[maindata$consci ==1] <- 1\nmaindata$SCICONF[maindata$consci >1 & maindata$consci <= 3 ] <- 0\n```\n\n## Independent variables:\n\n### 1. Religious attendance (Church attendance by religious category)\n\nIn this paper, I define religous attendance as categories of church attendance for each type of religious affiliation.\n\n5 categories of religiosity are created following the criterion outlined by Larry Peterson (2001). They are as follows: (1) religious conservatives, (2) Catholics, (3) religious moderates, (4) religious liberals, and (5) nones. Respondents are further sorted into two categories of church attendance: (a) low attendance and (b) high attendance. Religious nones with high attendance are eliminated as a category because it does not make analytical sense. In total, this gives us 9 categories. Each category is then transformed into a dummy variable, where 1 signals membership in that particular category. Religious conservatives with high church attendance will serve as the reference group in the analysis to follow.\n\n\n```{r}\n# prepare independent variables\n\n# first, religious affiliation. Peterson creates 5 religious categories:\n# (1) religious conservatives (2) catholics (3) religious conservatives\n# (4) religious moderates (5) religious liberals  (6) nones\n\nmaindata$aff <- NA\nmaindata$aff[maindata$relig == 2] <- \"Catholics\"\nmaindata$aff[maindata$relig == 4] <- \"Nones\"\nmaindata$aff[maindata$relig == 13] <- \"Religious conservatives\"\nmaindata$aff[maindata$relig != 2 & maindata$relig != 4 &  maindata$relig != 13 & maindata$fund == 1]  <- \"Religious conservatives\"\nmaindata$aff[maindata$relig != 2 & maindata$relig != 4 &  maindata$relig != 13 & maindata$fund == 2] <- \"Religious moderates\"\nmaindata$aff[maindata$relig != 2 & maindata$relig != 4 &  maindata$relig != 13 & maindata$fund == 3] <- \"Religious liberals\"\n\n# second, prepare church attendance with 2 categories\nmaindata$att <- NA\nmaindata$att[maindata$attend <= 5] <- \"Low att.\"\nmaindata$att[maindata$attend >5 & maindata$attend < 9 ] <- \"High att.\"\n\n# change them to ordered factors\natt_levels <- c(\"Low att.\", \"High att.\")\naff_levels <- c(\"Religious conservatives\", \n                \"Catholics\", \n                \"Religious moderates\", \n                \"Religious liberals\", \n                \"Nones\")\nmaindata$aff <- factor(maindata$aff, levels = aff_levels)\nmaindata$att <- factor(maindata$att, levels = att_levels)\n\n```\n\n### 2. Education\n\nEducation is operationalized by the *educ* variable in GSS, which measures the highest year of school completed. Respones of \"Don't know,\" and \"No answer\" are re-coded as NAs.\n\n```{r}\n# recode NAs\nmaindata$educ[maindata$educ >20] <- NA\n```\n\n### 3. Interaction between Religious Attendance and Education\n\nInteraction terms are constructed by taking the product of education and each church attendance by religious category dummy variable.\n\n```{r}\n# create dummy variables for dependent variable + interaction term\nmaindata <- maindata %>%\n  mutate(CHiAtt = if_else(str_detect(aff, \"conservative\") & str_detect(att, \"High\"),1,0)) %>%\n  mutate(CLoAtt = if_else(str_detect(aff, \"conservative\") & str_detect(att, \"Low\"),1,0)) %>% \n  mutate(CthHiAtt = if_else(str_detect(aff, \"Cat\") & str_detect(att, \"High\"),1,0)) %>%\n  mutate(CthLoAtt = if_else(str_detect(aff, \"Cat\") & str_detect(att, \"Low\"),1,0)) %>%\n  mutate(MHiAtt = if_else(str_detect(aff, \"moderate\") & str_detect(att, \"High\"),1,0))%>%\n  mutate(MLoAtt = if_else(str_detect(aff, \"moderate\") & str_detect(att, \"Low\"),1,0)) %>%\n  mutate(LHiAtt = if_else(str_detect(aff, \"liberal\") & str_detect(att, \"High\"),1,0)) %>%\n  mutate(LLoAtt = if_else(str_detect(aff, \"liberal\") & str_detect(att, \"Low\"),1,0)) %>%\n  mutate(NHiAtt = if_else(str_detect(aff, \"Nones\") & str_detect(att, \"High\"),1,0)) %>%\n  mutate(NLoAtt = if_else(str_detect(aff, \"Nones\") & str_detect(att, \"Low\"),1,0)) %>%\n  mutate(CHiAttXEduc = CHiAtt*educ) %>%\n  mutate(CLoAttXEduc = CLoAtt*educ) %>%\n  mutate(CthHiAttXEduc = educ*CthHiAtt) %>%\n  mutate(CthLoAttXEduc = educ*CthLoAtt) %>%\n  mutate(MHiAttXEduc = educ*MHiAtt) %>%\n  mutate(MLoAttXEduc = educ*MLoAtt) %>%\n  mutate(LHiAttXEduc = educ*LHiAtt)%>%\n  mutate(LLoAttXEduc = educ*LLoAtt) %>%\n  mutate(NLoAttXEduc = educ*NLoAtt) %>%\n  filter(NHiAtt == 0)\n```\n\n### 4. Interaction among religious Attendance, education, and birth cohort.\n\n## Control variables:\n\nThe following variables are controlled for: \n\n1. Size of place of interview (in 1000s)\n2. Marital status (married = 1)\n3. Gender (woman = 1)\n4. Race (non-white = 1)\n5. Age \n6. Cohort (birth year)\n7. Period (GSS year since 1972)\n8. Region (South = 1)\n\n\n```{r}\n# leave size as it is\n\n# recode NAs for age\nmaindata$age[maindata$age >97] <- NA\n\n# recode sex as a dummy with woman as 1.\nmaindata$gender_dum <- NA\nmaindata$gender_dum[maindata$sex == 1] <- 0\nmaindata$gender_dum[maindata$sex == 2] <- 1\n\n# recode race into a dummy, with non-white as 1.\nmaindata$race_dum <- NA\nmaindata$race_dum[maindata$race == 1] <- 0\nmaindata$race_dum[maindata$race > 1] <- 1\n\n# recode marital status into a dummy, with married as 1\nmaindata$marital_dum <- NA\nmaindata$marital_dum[maindata$marital == 1] <- 1\nmaindata$marital_dum[maindata$marital > 1 & maindata$marital <= 5] <- 0\n\n# recode region into a dummy, with south as 1.\nmaindata <- mutate(maindata, south = if_else(region >= 5 & region <= 7, 1, 0))\n\n# year 2000 was coded as NA for some reason ...\nmaindata$year[is.na(maindata$year)] <- 2000\n\n# create a new variable for cohort\nmaindata <- mutate(maindata, cohort_cont = year - age)\n\n# create a new variable for period\nmaindata <- mutate(maindata, period = year - 1972)\n\n```\n\n## Dealing with missing data:\n\n### Identifying the missing-ness\n\n\n```{r}\ntempData <- select(maindata, CHiAtt, CLoAtt, CthHiAtt, CthLoAtt, MHiAtt, MLoAtt, LHiAtt, LLoAtt, NLoAtt)\n\ntempData[!complete.cases(tempData),]\n```\n\n```{r}\ndv_data <- select(maindata, size, marital_dum, gender_dum, race_dum, age, south, educ, year)\n\nmissing_cases <- dv_data[!complete.cases(dv_data),]\n\n# check for no. of NAs in a column: \n# dim(filter(dv_data, is.na(marital_dum)))\n```\n\n\n```{r}\nno_missing <- tibble(\n  variable =  c(\"Size of place (1000s)\", \n                \"Marital status\", \n                \"Gender\", \n                \"Race\", \n                \"Age\", \n                \"Region\", \n                \"Education\",\n                \"Year of GSS\"),\n  num_missing = c(0, 19, 0, 0, 195, 0, 134,0))\n```\n\n\n```{r}\nkable(no_missing, \"latex\", booktabs = T, col.names = c(\"Variable\", \"No. of missing values\")) %>% \n  kable_styling(latex_options = \"striped\")\n```\n\n```{r}\nwrite_csv(missing_cases, \"missing_cases.csv\")\n```\n```{r}\nmissing_tb <- read.csv(\"missing_cases.csv\")\n```\n\n```{r, results='asis'}\nstargazer(missing_tb, \n          header = FALSE,\n          title = \"Dess. stats. of obs. with >= 1 missing value\",\n          covariate.labels = c(\"Size of place (1000s)\", \"Marital status\", \"Gender\", \"Race\", \"Age\", \"Region\", \"Education\", \"Year of GSS\"),\n          notes = \"Based on data from the 1972-2016 GSS\"\n          )\n```\n\n```{r}\naggr_plot <- aggr(dv_data, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(dv_data), cex.axis=.7, gap=3, ylab=c(\"Histogram of missing data\",\"Pattern\"))\n```\n\n### Imputing missing values using single imputation:\n\nI attempted to do multiple imputation by chained equations, but felt pretty defeated by the attempts. I'm not sure I understand how to do it in R yet. To be precise, I'm not sure how to pool the multiple imputated models that MICE generates. It's been pretty frustrating. \n\nSo I'll just go with single imputation by means for continuous variables (age and education), and single imputation by median for dummy variables (marital status) for now.\n\n```{r}\nmaindata_imputed <- mutate(maindata, marital_imputed = marital_dum, age_imputed = age, educ_imputed = educ) %>%\n  drop_na(CHiAtt, CLoAtt, CthHiAtt, CthLoAtt, MHiAtt, MLoAtt, LHiAtt, LLoAtt, NLoAtt)\n```\n\n\n```{r}\nmaindata_imputed$marital_imputed[is.na(maindata_imputed$marital_imputed)] <- median(maindata_imputed$marital_dum, na.rm = TRUE)\n\nmaindata_imputed$age_imputed[is.na(maindata_imputed$age_imputed)] <- mean(maindata_imputed$age, na.rm = TRUE)\n\nmaindata_imputed$educ_imputed[is.na(maindata_imputed$educ_imputed)] <- mean(maindata_imputed$educ, na.rm = TRUE)\n\n# create a new variable for cohort\nmaindata_imputed <- mutate(maindata_imputed, cohort_cont_imputed = year - age_imputed)\n```\n\n```{r}\ndv_data <- select(maindata_imputed, marital_imputed, age_imputed, educ_imputed)\n\nmissing_cases <- dv_data[!complete.cases(dv_data),]\n\n# dim(missing_cases)\n\n# i found no missing cases! success!\n```\n\n\n# Analysis\n\n## Summary Statistics:\n\nFirst, I present the summary statistics \n\n```{r}\n# data dropped list-wise \nrdy_data <-   maindata %>%\n  mutate(CHiAttXEducXBc = CHiAtt*educ*cohort_cont) %>%\n  mutate(CLoAttXEducXBc = CLoAtt*educ*cohort_cont) %>%\n  mutate(CthHiAttXEducXBc = educ*CthHiAtt*cohort_cont) %>%\n  mutate(CthLoAttXEducXBc = educ*CthLoAtt*cohort_cont) %>%\n  mutate(MHiAttXEducXBc = educ*MHiAtt*cohort_cont) %>%\n  mutate(MLoAttXEducXBc = educ*MLoAtt*cohort_cont) %>%\n  mutate(LHiAttXEducXBc = educ*LHiAtt*cohort_cont)%>%\n  mutate(LLoAttXEducXBc = educ*LLoAtt*cohort_cont) %>%\n  mutate(NLoAttXEducXBc = educ*NLoAtt*cohort_cont) %>%\n  drop_na(SCICONF, size, age, south, educ, marital_dum, race_dum, year, CHiAtt, CLoAtt, CthHiAtt, CthLoAtt, MHiAtt, MLoAtt, LHiAtt, LLoAtt, NLoAtt)\n\nrdy_imputed <-maindata_imputed %>%\n  mutate(CHiAttXEduc_imp = CHiAtt*educ_imputed) %>%\n  mutate(CLoAttXEduc_imp = CLoAtt*educ_imputed) %>%\n  mutate(CthHiAttXEduc_imp = educ_imputed*CthHiAtt) %>%\n  mutate(CthLoAttXEduc_imp = educ_imputed*CthLoAtt) %>%\n  mutate(MHiAttXEduc_imp = educ_imputed*MHiAtt) %>%\n  mutate(MLoAttXEduc_imp = educ_imputed*MLoAtt) %>%\n  mutate(LHiAttXEduc_imp = educ_imputed*LHiAtt)%>%\n  mutate(LLoAttXEduc_imp = educ_imputed*LLoAtt) %>%\n  mutate(NLoAttXEduc_imp = educ_imputed*NLoAtt) %>%\n  mutate(CHiAttXEducXBc_imp = CHiAtt*educ_imputed*cohort_cont_imputed) %>%\n  mutate(CLoAttXEducXBc_imp = CLoAtt*educ_imputed*cohort_cont_imputed) %>%\n  mutate(CthHiAttXEducXBc_imp = educ_imputed*CthHiAtt*cohort_cont_imputed) %>%\n  mutate(CthLoAttXEducXBc_imp = educ_imputed*CthLoAtt*cohort_cont_imputed) %>%\n  mutate(MHiAttXEducXBc_imp = educ_imputed*MHiAtt*cohort_cont_imputed) %>%\n  mutate(MLoAttXEducXBc_imp = educ_imputed*MLoAtt*cohort_cont_imputed) %>%\n  mutate(LHiAttXEducXBc_imp = educ_imputed*LHiAtt*cohort_cont_imputed)%>%\n  mutate(LLoAttXEducXBc_imp = educ_imputed*LLoAtt*cohort_cont_imputed) %>%\n  mutate(NLoAttXEducXBc_imp = educ_imputed*NLoAtt*cohort_cont_imputed) %>%\n  drop_na(SCICONF)\n```\n\n\n## My models:\n\nI build and test a total of 5 models in this paper. \n\n### Model 1:\nModel 1 regresses the dependent variable, confidence in science, against the control variables.\n\n$$ Y_{i} =  \\beta_{0} + \\sum_{j = 1}^8\\beta_{j}C_{ij} + \\varepsilon_i$$\nwhere $Y_{i}$ is $log(\\frac{P(Confident)}{1-P(Confident)})$, the log odds that respondent $i$ would have confidence in science, and $C_{ij}$ is a control variable: in order, size of the place the respondent is from, marital status, gender, race, age, birth cohort, period the survey was conducted, and whether s/he is from the South.\n\n### Model 2:\nModel 2 further specifies model 1  by considering the main effect of religious attendance in addition to the control variables.\n\n$$ Y_{i} =  \\beta_{0} + \\sum_{j = 1}^8\\beta_{j}C_{ij} + \\sum_{j = 9}^{16}\\beta_{j}R_{ij}+  \\varepsilon_i$$\n\nwhere $Y_{i}$ is $log(\\frac{P(Confident)}{1-P(Confident)})$, the log odds that respondent $i$ would have confidence in science, $C_{ij}$ are the control variables, and $R_{ij}$ refers to the dummy variables for religious attendance.\n\n### Model 3: \nModel 3 further specifies model 2 by considering the main effect of education on confidence in science..\n\n$$ Y_{i} =  \\beta_{0} + \\sum_{j = 1}^8\\beta_{j}C_{ij} + \\sum_{j = 9}^{16}\\beta_{j}R_{ij}+ \\beta_{17}Ed_{i}  + \\varepsilon_i$$\n\nwhere $Y_{i}$ is $log(\\frac{P(Confident)}{1-P(Confident)})$, the log odds that respondent $i$ would have confidence in science, $C_{ij}$ are the control variables, $R_{ij}$ refers to the dummy variables for religious attendance, and $Ed_{i}$ refers to education (no. of years of schooling).\n\n### Model 4: \nModel 4 further specifies model 3 by considering the interaction effect between education and religous attendance and our dependent variable, confidence in science.\n\n$$ Y_{i} =  \\beta_{0} + \\sum_{j = 1}^8\\beta_{j}C_{ij} + \\sum_{j = 9}^{16}\\beta_{j}R_{ij}+ \\beta_{17}Ed_{i}  +  \\sum_{j = 18}^{25}\\beta_{j}R_{ij}Ed_{ij}+\\varepsilon_i$$\n\nwhere $Y_{i}$ is $log(\\frac{P(Confident)}{1-P(Confident)})$, the log odds that respondent $i$ would have confidence in science, $C_{ij}$ are the control variables, $R_{ij}$ refers to the dummy variables for religious attendance, $Ed_{i}$ refers to education, and $R_{ij}Ed_{ij}$ refers to the interaction terms between each dummy variable of religious attendance and education.\n\n### Model 5:\nMy final model, model 5, specifies model 4 by considering a further triple interaction effect of birth cohort X education X religous attendance.\n\n$$ Y_{i} =  \\beta_{0} + \\sum_{j = 1}^8\\beta_{j}C_{ij} + \\sum_{j = 9}^{16}\\beta_{j}R_{ij}+ \\beta_{17}Ed_{i}  +  \\sum_{j = 18}^{25}\\beta_{j}R_{ij}Ed_{ij}+ \\sum_{j = 18}^{25}\\beta_{j}R_{ij}Ed_{ij}Bc_{ij} + \\varepsilon_i$$\n\nwhere $Y_{i}$ is $log(\\frac{P(Confident)}{1-P(Confident)})$, the log odds that respondent $i$ would have confidence in science, $C_{ij}$ are the control variables, $R_{ij}$ refers to the dummy variables for religious attendance, $Ed_{i}$ refers to education, $R_{ij}Ed_{ij}$ refers to the interaction terms between religious attendance and education,and $R_{ij}Ed_{ij}Bc_{ij}$ refers to the interaction term between birth cohort, education, and religious attendance.\n\n## Results:\n\n### What happens when observations with missing values are dropped?\n```{r}\nlm1a <- glm(SCICONF~size + marital_dum + gender_dum + race_dum + age + cohort_cont + south , family = binomial(link = \"logit\"),data = rdy_data )\n\nlm2a <- glm(SCICONF~size + marital_dum + gender_dum + race_dum + age + cohort_cont+ south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt, family = binomial(link = \"logit\"),data = rdy_data )\n\nlm3a <- glm(SCICONF~size + marital_dum + gender_dum + race_dum + age + cohort_cont  + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ, family = binomial(link = \"logit\"),data = rdy_data )\n\nlm4a <- glm(SCICONF~size + marital_dum + gender_dum + race_dum + age + cohort_cont + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ +CLoAttXEduc + CthHiAttXEduc + CthLoAttXEduc + MHiAttXEduc + MLoAttXEduc + LHiAttXEduc + LLoAttXEduc + NLoAttXEduc, family = binomial(link = \"logit\"),data = rdy_data )\n\nlm5a <- glm(SCICONF~size + marital_dum + gender_dum + race_dum + age + cohort_cont + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ +CLoAttXEduc + CthHiAttXEduc + CthLoAttXEduc + MHiAttXEduc + MLoAttXEduc + LHiAttXEduc + LLoAttXEduc + NLoAttXEduc + CLoAttXEducXBc + CthHiAttXEducXBc + CthLoAttXEducXBc + MHiAttXEducXBc + MLoAttXEducXBc + LHiAttXEducXBc + LLoAttXEducXBc + NLoAttXEducXBc, family = binomial(link = \"logit\"),data = rdy_data )\n```\n\n```{r}\nlm1a$BIC <- BIC(lm1a)\nlm2a$BIC <- BIC(lm2a)\nlm3a$BIC <- BIC(lm3a)\nlm4a$BIC <- BIC(lm4a)\nlm5a$BIC <- BIC(lm5a)\n```\n\n```{r,  results='asis'}\nstargazer(lm1a, lm2a, lm3a, \n          header = FALSE,\n          digits = 3,\n          single.row = TRUE,\n          title = \"Logit model of Confidence in Science (NAs dropped)\",\n          dep.var.caption  = \"Log Odds of Confidence in Science\",\n          covariate.labels = c(\"Size\", \n                               \"Marital\",\n                               \"Gender\",\n                               \"Race\",\n                               \"Age\",\n                               \"Birth Cohort\",\n                               \"Region\",\n                               \"CLoAtt\",\n                               \"CthHiAtt\",\n                               \"CthLoAtt\",\n                               \"MHiAtt\",\n                               \"MLoAtt\",\n                               \"LHiAtt\",\n                               \"LLoAtt\",\n                               \"NLoAtt\",\n                               \"Education\"\n                               ),              \n          column.labels = c(\"Model 1A\", \"Model 2A\", 'Model 3A'),\n          model.numbers = FALSE,\n          keep.stat=c( \"n\", \"bic\"),\n          star.cutoffs = c(0.05, 0.01, 0.001),\n          notes = \"Based on data from the 1972-2016 GSS. All observations containing NAs are removed.\"\n          )\n```\n\n```{r,  results='asis'}\nstargazer(lm4a, lm5a, \n          header = FALSE,\n          digits = 3,\n          single.row = TRUE,\n          title = \"Logit model of Confidence in Science (NAs dropped)\",\n          dep.var.caption  = \"Log Odds of Confidence in Science\",\n          covariate.labels = c(\"Size\", \n                               \"Marital\",\n                               \"Gender\",\n                               \"Race\",\n                               \"Age\",\n                               \"Birth Cohort\",\n                               \"Region\",\n                               \"CLoAtt\",\n                               \"CthHiAtt\",\n                               \"CthLoAtt\",\n                               \"MHiAtt\",\n                               \"MLoAtt\",\n                               \"LHiAtt\",\n                               \"LLoAtt\",\n                               \"NLoAtt\",\n                               \"Education\",\n                               \"CLoAtt X Ed\",\n                               \"CthHiAtt X Ed\",\n                               \"CthLoAtt X Ed\",\n                               \"MHiAtt X Ed\",\n                               \"MLoAtt X Ed\",\n                               \"LHiAtt X Ed\",\n                               \"LLoAtt X Ed\",\n                               \"NLoAtt X Ed\",\n                               \"CLoAtt X Ed X Bc\",\n                               \"CthHiAtt X Ed X Bc\",\n                               \"CthLoAtt X Ed X Bc\",\n                               \"MHiAtt X Ed X Bc\",\n                               \"MLoAtt X Ed X Bc\",\n                               \"LHiAtt X Ed X Bc\",\n                               \"LLoAtt X Ed X Bc\",\n                               \"NLoAtt X Ed X Bc\"\n                               ),              \n          column.labels = c(\"Model 4A\", \"Model 5A\"),\n          model.numbers = FALSE,\n          keep.stat=c( \"n\", \"bic\"),\n          star.cutoffs = c(0.05, 0.01, 0.001),\n          notes = \"Based on data from the 1972-2016 GSS. All observations containing NAs are removed.\"\n          )\n```\n\nModels 4 and 5 tell very interesting stories. Model 4 tells us that the interaction effect between religious attendance and education exists only for certain group/attendance combinations: only moderates who attend church frequently, liberals who attended church infrequently, and religious nones had statistically significant coefficients. Moderates with high church attedance had a negative coefficient: this meant that they experience lower gains per unit of education gained than religious conservatives with high attendance (and also every other group!). That's rather intriguing. The results for liberals and religious nones might be more expected: education increases their likelihood of being confident in science more than the other religious attendance categories. \n\nUnfortunately, if their BIC scores relative to model 3 tell us that we may want to prefer the more parismonious model 3 instead. Model 3 tells us that increases in years of education mean a individual is more likely to be confident in science, ceteris paribus. It also tells us that each religious attendance category is associated with a different likelihood of being confident in science, ceteris paribus.\n\n### What happens when missing values are imputed via single imputation?\n\n```{r}\n\nlm1b <- glm(SCICONF~size + marital_imputed + gender_dum + race_dum + age_imputed + cohort_cont +  south , family = binomial(link = \"logit\"),data = rdy_imputed )\n\nlm2b <- glm(SCICONF~size + marital_imputed + gender_dum + race_dum + age_imputed + cohort_cont  + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt, family = binomial(link = \"logit\"),data = rdy_imputed )\n\nlm3b <- glm(SCICONF~size + marital_imputed + gender_dum + race_dum + age_imputed + cohort_cont  + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ_imputed, family = binomial(link = \"logit\"),data = rdy_imputed )\n\nlm4b <- glm(SCICONF~size + marital_imputed + gender_dum + race_dum + age_imputed + cohort_cont + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ_imputed +CLoAttXEduc_imp + CthHiAttXEduc_imp + CthLoAttXEduc_imp + MHiAttXEduc_imp + MLoAttXEduc_imp + LHiAttXEduc_imp + LLoAttXEduc_imp + NLoAttXEduc_imp, family = binomial(link = \"logit\"),data = rdy_imputed )\n\nlm5b <- glm(SCICONF~size + marital_imputed + gender_dum + race_dum + age_imputed + cohort_cont + south + CLoAtt + CthHiAtt + CthLoAtt + MHiAtt + MLoAtt + LHiAtt + LLoAtt + NLoAtt + educ_imputed +CLoAttXEduc_imp + CthHiAttXEduc_imp + CthLoAttXEduc_imp + MHiAttXEduc_imp + MLoAttXEduc_imp + LHiAttXEduc_imp + LLoAttXEduc_imp + NLoAttXEduc_imp + CLoAttXEducXBc_imp + CthHiAttXEducXBc_imp + CthLoAttXEducXBc_imp + MHiAttXEducXBc_imp + MLoAttXEducXBc_imp + LHiAttXEducXBc_imp + LLoAttXEducXBc_imp + NLoAttXEducXBc_imp, family = binomial(link = \"logit\"),data = rdy_imputed )\n```\n\n```{r}\nlm1b$BIC <- BIC(lm1b)\nlm2b$BIC <- BIC(lm2b)\nlm3b$BIC <- BIC(lm3b)\nlm4b$BIC <- BIC(lm4b)\nlm5b$BIC <- BIC(lm5b)\n```\n\n```{r,  results='asis'}\nstargazer(lm1b, lm2b, lm3b, \n          header = FALSE,\n          digits = 3,\n          single.row = TRUE,\n          title = \"Logit model of Confidence in Science (Single imput.)\",\n          dep.var.caption  = \"Log Odds of Confidence in Science\",\n          covariate.labels = c(\"Size\", \n                               \"Marital\",\n                               \"Gender\",\n                               \"Race\",\n                               \"Age\",\n                               \"Birth Cohort\",\n                               \"Region\",\n                               \"CLoAtt\",\n                               \"CthHiAtt\",\n                               \"CthLoAtt\",\n                               \"MHiAtt\",\n                               \"MLoAtt\",\n                               \"LHiAtt\",\n                               \"LLoAtt\",\n                               \"NLoAtt\",\n                               \"Education\"\n                               ),              \n          column.labels = c(\"Model 1B\", \"Model 2B\", 'Model 3B'),\n          model.numbers = FALSE,\n          keep.stat=c( \"n\", \"bic\"),\n          star.cutoffs = c(0.05, 0.01, 0.001),\n          notes = \"Data: 1972-2016 GSS. NA values imputed using single imputation.\"\n          )\n```\n\n```{r,  results='asis'}\nstargazer(lm4b, lm5b, \n          header = FALSE,\n          digits = 3,\n          single.row = TRUE,\n          title = \"Logit model of Confidence in Science (Single imput.)\",\n          dep.var.caption  = \"Log Odds of Confidence in Science\",\n          covariate.labels = c(\"Size\", \n                               \"Marital\",\n                               \"Gender\",\n                               \"Race\",\n                               \"Age\",\n                               \"Birth Cohort\",\n                               \"Region\",\n                               \"CLoAtt\",\n                               \"CthHiAtt\",\n                               \"CthLoAtt\",\n                               \"MHiAtt\",\n                               \"MLoAtt\",\n                               \"LHiAtt\",\n                               \"LLoAtt\",\n                               \"NLoAtt\",\n                               \"Education\",\n                               \"CLoAtt X Ed\",\n                               \"CthHiAtt X Ed\",\n                               \"CthLoAtt X Ed\",\n                               \"MHiAtt X Ed\",\n                               \"MLoAtt X Ed\",\n                               \"LHiAtt X Ed\",\n                               \"LLoAtt X Ed\",\n                               \"NLoAtt X Ed\",\n                               \"CLoAtt X Ed X Bc\",\n                               \"CthHiAtt X Ed X Bc\",\n                               \"CthLoAtt X Ed X Bc\",\n                               \"MHiAtt X Ed X Bc\",\n                               \"MLoAtt X Ed X Bc\",\n                               \"LHiAtt X Ed X Bc\",\n                               \"LLoAtt X Ed X Bc\",\n                               \"NLoAtt X Ed X Bc\"\n                               ),              \n          column.labels = c(\"Model 4B\", \"Model 5B\"),\n          model.numbers = FALSE,\n          keep.stat=c( \"n\", \"bic\"),\n          star.cutoffs = c(0.05, 0.01, 0.001),\n          notes = \"Data: 1972-2016 GSS. NA values imputed using single imputation.\"\n          )\n```\n\nIt turns out that the two models don't really differ by much â€” in fact they are almost identical. There are no changes in statistical signifance of coefficients. There are a few coefficients for the means imputed model that are slightly higher, but it's hard to interpret anything substantial from this. This isn't a surprise, since only 66 of the imputed values ultimately matters in the end: that's the no. of observations we gained from the imputing. 66 out of 37430 observations amounts to just $`r 66/37430*100`$% of the total. No wonder I barely see a difference.\n\n### What happens when we do MICE?\n\nSo I did go back and try MICE again. But, again, to no avail.\n\nMICE (at least the pmm method I'm using) is painfully, *painfully* slow when you have many independent variables as I do. I need to find out how to optimize it or something. This takes > 1hr just to impute data, so I'm giving up.\n\n\n```{r, eval = FALSE, echo = TRUE}\npre_mice <- maindata %>%\n  select(SCICONF, size, marital_dum, gender_dum, race_dum, age, cohort_cont, south, CLoAtt, CthHiAtt, CthLoAtt, MHiAtt, MLoAtt, LHiAtt, LLoAtt, NLoAtt, educ) %>%\n  drop_na(SCICONF)\n```\n\n```{r, eval = FALSE, echo = TRUE}\n miced_data <- mice(pre_mice,m=3,maxit=50,meth='pmm',seed=500)\n```\n\n# Final thoughts:\n\nThis exercise has been unexpectedly rewarding. First, my encounter with MICE has been my first big brush with . Learning how to check NA values has let me discover problems with how I coded some of my variables. I'll have to re-visit all of it another time!",
    "created" : 1539281062892.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "431610503",
    "id" : "7F78971E",
    "lastKnownWriteTime" : 1528058284,
    "last_content_update" : 1528058284,
    "path" : "~/Documents/soc_stats_xi/hw7/hw7.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}